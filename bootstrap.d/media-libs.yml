packages:
  - name: freetype
    source:
      subdir: 'ports'
      git: 'https://gitlab.freedesktop.org/freetype/freetype.git'
      tag: 'VER-2-11-0'
      version: '2.11.0'
      tools_required:
        - cross-toolchain
      regenerate:
        - args: ['./autogen.sh']
          environ:
            NOCONFIGURE: '1'
        - args: ['cp',
            '@BUILD_ROOT@/tools/cross-automake-v1.15/share/automake-1.15/config.sub',
            '@THIS_SOURCE_DIR@/builds/unix/']
    tools_required:
      - cross-toolchain
    pkgs_required:
      - mlibc
      - bzip2
      - libpng
      - zlib
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=@OPTION:arch-triple@'
        - '--prefix=/usr'
        - '--disable-static'
        - '--with-harfbuzz=no'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: libglvnd
    source:
      subdir: 'ports'
      git: 'https://gitlab.freedesktop.org/glvnd/libglvnd.git'
      tag: 'v1.4.0'
      version: '1.4.0'
    tools_required:
      - cross-toolchain
      - virtual: pkgconfig-for-target
        triple: "@OPTION:arch-triple@"
    pkgs_required:
      - mlibc
      - libx11
      - libxext
    configure:
      - args:
        - 'meson'
        - '--cross-file'
        - '@SOURCE_ROOT@/scripts/meson-@OPTION:arch-triple@.cross-file'
        - '--prefix=/usr'
        - '--libdir=lib'
        - '--buildtype=debugoptimized'
        - '-Dasm=disabled'
        - '-Dx11=enabled'
        - '-Degl=true'
        - '-Dglx=enabled'
        - '-Dgles1=true'
        - '-Dgles2=true'
        - '-Dtls=true'
        - '@THIS_SOURCE_DIR@'
    build:
      - args: ['ninja']
      - args: ['ninja', 'install']
        environ:
          DESTDIR: '@THIS_COLLECT_DIR@'

  - name: libpng
    source:
      subdir: ports
      git: https://github.com/glennrp/libpng
      tag: 'v1.6.37'
      version: '1.6.37'
      tools_required:
        - cross-toolchain
      regenerate:
        - args: ['autoreconf', '-fvi']
    tools_required:
        - cross-toolchain
    configure:
      - args:
        - "@THIS_SOURCE_DIR@/configure"
        - "--host=@OPTION:arch-triple@"
        - "--prefix=/usr"
    build:
      - args: ["make", "-j@PARALLELISM@"]
      - args: ["make", "DESTDIR=@THIS_COLLECT_DIR@", "install"]
