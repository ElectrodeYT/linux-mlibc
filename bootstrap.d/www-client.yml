packages:
  - name: lynx
    # default: false
    source:
      subdir: 'ports'
      url: 'https://invisible-mirror.net/archives/lynx/tarballs/lynx2.8.9rel.1.tar.bz2'
      format: 'tar.bz2'
      extract_path: 'lynx2.8.9rel.1'
      tools_required:
        - cross-toolchain
      regenerate:
        - args: ['cp',
            '@BUILD_ROOT@/tools/cross-automake-v1.15/share/automake-1.15/config.sub',
            '@THIS_SOURCE_DIR@/']
    tools_required:
      - cross-toolchain
      # - host-pkg-config
      # - system-gcc
      # - virtual: pkgconfig-for-target
      #   triple: x86_64-managarm
    pkgs_required:
      - zlib
      - ncurses
      - gnutls
    configure:
      - args:
        - '@THIS_SOURCE_DIR@/configure'
        - '--host=@OPTION:arch-triple@'
        - '--prefix=/usr'
        - '--disable-static'
        - '--with-zlib'
        - '--with-bzlib'
        - '--with-screen=ncurses'
        - '--with-gnutls'
        # - '--enable-gnutls-compat'
        - '--sysconfdir=/etc/lynx'
        - '--datadir=/usr/share/doc/lynx-2.8.9rel.1'
        - '--enable-locale-charset'
        - '--enable-ipv6'
        - '--disable-finger'
        - '--disable-gopher'
        - '--disable-news'
        - '--disable-ftp'
        - '--disable-dired'
        - 'CFLAGS=-I@SYSROOT_DIR@/usr/include/openssl'
        environ:
          PKG_CONFIG_SYSROOT_DIR: '@BUILD_ROOT@/system-root'
          PKG_CONFIG_LIBDIR: '@BUILD_ROOT@/system-root/usr/lib/pkgconfig:@BUILD_ROOT@/system-root/usr/share/pkgconfig'
    build:
      - args: ['make', '-j@PARALLELISM@']
      - args: ['make', 'DESTDIR=@THIS_COLLECT_DIR@', 'install-full']
